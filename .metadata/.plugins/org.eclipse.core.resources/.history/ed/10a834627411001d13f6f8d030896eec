#ifndef _DELAY_H
#define _DELAY_H

#include "stm32f1xx_hal.h"

//΢�������ʱ����
__STATIC_INLINE void sw_delay_us(uint32_t number_of_us);
//���������ʱ����
__STATIC_INLINE void sw_delay_ms(uint32_t number_of_ms);

void SysTick_Handler(void);

uint32_t time_delay;


__STATIC_INLINE void sw_delay_us(uint32_t number_of_us)
{
	//SYSTICK分频--1us的系统时钟中断
	if (SysTick_Config(HAL_RCC_GetHCLKFreq()/1000000))
	{

		while (1);
	}
	time_delay=number_of_us;//读取定时时间
	while(time_delay);
	SysTick->CTRL=0x00; //关闭计数器
	SysTick->VAL =0X00; //清空计数器


}
__STATIC_INLINE void sw_delay_ms(uint32_t number_of_ms)
{

    //SYSTICK分频--1ms的系统时钟中断
    if (SysTick_Config(HAL_RCC_GetHCLKFreq()/1000))
    {

        while (1);
    }
    time_delay=number_of_ms;//读取定时时间
    while(time_delay);
    SysTick->CTRL=0x00; //关闭计数器
    SysTick->VAL =0X00; //清空计数器


}

void SysTick_Handler(void){
	if(time_delay)time_delay--;
}

#endif

